# 📚 圖書股長自動排班與管理系統 (Library Volunteer Roster System)
作者：臺北市立建國高級中學圖書館潘威歷主任 20260203
這是一個基於 **Google Apps Script (GAS)** 與 **Google Sheets** 開發的自動化排班系統。專為高中職圖書館設計，解決每學期繁瑣的圖書股長排班、假日排除、補假調整及出勤統計問題。

## ✨ 主要功能

* **🚀 一鍵建置系統**：全自動產生所需的工作表結構 (`Config`, `Librarians`, `Result`, `Stats`)。
* **📅 智慧學期設定**：
* 透過對話框輸入學期起訖日，自動產生全學期的週六、週日清單。
* 自動預留「三次段考」的排程空間供管理員填寫。


* **⚖️ 公平輪值演算法**：
* 採用「循環隊列 (Circular Queue)」邏輯，遇假日自動順延，確保每班輪值次數平均。
* 高一、高二、高三採獨立隊列，互不影響。


* **🎓 高三停勤機制**：支援設定「高三停止值勤日」（如統測前或畢業前），該日期後高三自動免勤。若設為開學日，則全學期免勤。
* **📧 自動化通知**：可設定每日自動寄送 Email 提醒明日值勤的學生。
* **📊 期末結算統計**：一鍵掃描整學期簽到表，計算應到次數、實到次數與出勤百分比，並支援設定統計截止日。

## 🛠️ 安裝方式

本系統不需要安裝任何軟體，僅需一個 Google 帳號。

1. 建立一個全新的 **Google 試算表 (Google Sheets)**。
2. 點選上方選單的 **「擴充功能 (Extensions)」** > **「Apps Script」**。
3. 將本專案的 `Code.gs` 程式碼完整複製並貼上，覆蓋原本的內容。
4. 按下 `💾 儲存`。
5. 回到試算表，**重新整理網頁**。
6. 您將會在選單列看到新增的 **「📚 圖書股長系統」** 選單。

## 📖 操作流程

### 1. 系統初次建置

1. 點選選單 **「🚀 1. 系統初次建置」**。
2. 依序輸入：
* **學期開始日期** (例如：`2026/02/23`)
* **學期結束日期** (例如：`2026/06/30`)
* **高三停勤開始日** (例如：`2026/05/27`，若全學期皆不排高三，請填入開始日期)


3. 系統會自動建立所有工作表，並填入假日。

### 2. 微調設定 (Config 工作表)

系統建立後，請至 `Config` 工作表進行微調：

* **段考日期**：在自動產生的「第一次段考」等欄位填入實際日期。
* **補課設定**：若某個週六是補行上班日（學生要到校），請將該週六後面的「免勤勾選」**取消**。
* **國定假日**：手動新增國定假日（如二二八、清明節）並打勾免勤。

### 3. 建立名單 (Librarians 工作表)

* 系統已預設填入高一至高三的所有班級。
* **初期**：可先不填姓名，直接排班。
* **後期**：填入各班圖書股長的 **姓名** 與 **Email**。填入姓名後，排班表會自動顯示如 `1年1班 (王小明)`。

### 4. 產生值勤表

1. 點選選單 **「3. 產生/更新值勤表」**。
2. 系統會生成 `Result` 工作表，包含日期、星期、各年級班級與簽到欄。
3. **列印**：您可以直接列印此表供學生每日簽到。

### 5. 設定自動寄信 (選用)

若需要系統每日自動寄信提醒學生：

1. 進入 Apps Script 編輯器。
2. 左側選單點選 **「觸發條件 (Triggers)」** (鬧鐘圖示)。
3. **新增觸發條件**：
* 執行功能：`sendDailyReminders`
* 活動來源：`時間驅動`
* 觸發條件：`白天的計時器`
* 時間：`下午 4 點到 5 點` (建議放學前提醒)



### 6. 期末統計

1. 點選選單 **「📊 4. 期末結算統計」**。
2. 輸入 **統計截止日期** (預設為今天)。
3. 系統會生成 `Stats` 工作表，列出全校圖書股長的出勤率報表。

## 💡 常見問題與技巧

* **Q: 如何讓高三這學期完全不用值勤？**
* A: 在初次建置時，將「高三停勤開始日」設定為與「學期開始日期」同一天即可。


* **Q: 值勤表出現 (1), (2) 是什麼意思？**
* A: 這是因為您在姓名欄填入了座號（純數字）。系統預設會忽略純數字的姓名，請填入中文姓名即可正常顯示。


* **Q: 紙本簽到表希望隱藏高三欄位？**
* A: 若高三整學期免勤，建議在 `Result` 工作表直接選取高三的欄位 (G, H 欄) 按右鍵「隱藏」，列印時版面會更美觀。



## 📝 授權 (License)

MIT License. 歡迎自由使用、修改或應用於教育現場。

---

**Made with ❤️ for Library Administration**